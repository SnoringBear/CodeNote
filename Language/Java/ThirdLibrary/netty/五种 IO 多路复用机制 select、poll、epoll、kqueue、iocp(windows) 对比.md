# 五种 I/O 多路复用机制 select、poll、epoll、kqueue、iocp(windows) 对比

### select、poll、epoll、kqueue、iocp(windows)

这里我将对比一下常见的多路复用技术：select、poll、epoll、kqueue 和 IOCP（Windows）。

1. select

   ：

   - 优点：
     - 跨平台，支持多种操作系统。
     - 适用于少量连接的场景。
   - 缺点：
     - 效率较低，随着文件描述符数量的增加，性能下降明显。
     - 每次调用都需要将文件描述符集合从用户态复制到内核态，造成额外开销。

2. poll

   ：

   - 优点：
     - 跨平台，支持多种操作系统。
     - 对于大量连接的情况下，比 select 更有效率一些。
   - 缺点：
     - 仍然需要遍历整个描述符集合，性能不足以应对大规模连接。

3. epoll

   ：

   - 优点：
     - 采用事件通知机制，只有活跃的连接会被通知，效率较高。
     - 支持水平触发和边缘触发两种模式。
     - 支持ET（边缘触发）模式，提高了性能。
   - 缺点：
     - 仅在 Linux 平台可用，不具有跨平台性。
     - 在连接数量较少时，与 poll 的性能差距不大。

4. kqueue

   ：

   - 优点：
     - 适用于 BSD 系统（如 macOS、FreeBSD 等），效率较高。
     - 支持水平触发和边缘触发两种模式。
     - 提供了更好的扩展性和性能。
   - 缺点：
     - 不具备跨平台性，仅在 BSD 系统下可用。

5. IOCP

   （Windows）：

   - 优点：
     - 高性能，适用于 Windows 平台。
     - 采用了异步 I/O 模型，不会阻塞工作线程。
     - 可以处理大量并发连接。
   - 缺点：
     - 不具备跨平台性，仅在 Windows 系统下可用。
     - 编程模型较为复杂，学习成本较高。

综上所述，select 和 poll 在大规模连接场景下性能较差，而 epoll 和 kqueue 则具有更好的性能和扩展性，其中 epoll 更适用于 Linux 平台，而 kqueue 则适用于 BSD 系统。而对于 Windows 平台，IOCP 是首选的高性能多路复用技术。