在 Lua 中，`pairs` 和 `ipairs` 都用于遍历表（table），但它们的工作方式和应用场景有所不同。

------

## **1. `pairs` 适用于遍历所有键值对（无序）**

`pairs` 用于遍历 **所有 key-value 对**，包括**字符串键和整数键**，但它的遍历顺序**不确定**，适用于遍历普通的 Lua table（即哈希表）。

### **示例**

```
lua复制编辑local t = {a = 1, b = 2, [3] = 3}

for k, v in pairs(t) do
    print(k, v)
end
```

#### **可能输出（顺序不固定）**

```
css复制编辑a   1
b   2
3   3
```

🔹 `pairs` 可以遍历 **非数值键**，如 `a` 和 `b`。

------

## **2. `ipairs` 适用于遍历数组部分（有序）**

`ipairs` 仅用于遍历 **数组部分（索引从 1 开始的连续整数键）**，它按 **顺序递增** 访问，**遇到 `nil` 就停止**。

### **示例**

```
lua复制编辑local t = {10, 20, 30, nil, 50}

for i, v in ipairs(t) do
    print(i, v)
end
```

#### **输出**

```
复制编辑1   10
2   20
3   30
```

🔹 **`ipairs` 在遇到 `nil` 时会终止遍历**，所以 `50` 没有被打印。

------

## **3. `pairs` vs `ipairs` 总结**

|                | `pairs`                                | `ipairs`                       |
| -------------- | -------------------------------------- | ------------------------------ |
| **适用范围**   | 遍历**所有键值对**（哈希表、数组部分） | 仅遍历**数组部分（整数索引）** |
| **遍历顺序**   | **无序**（由 Lua 内部决定）            | **按索引顺序递增**             |
| **遇到 `nil`** | **不会终止**                           | **遇到 `nil` 立即终止**        |
| **适用场景**   | 遍历键值混合表（哈希表）               | 遍历数组（连续整数索引）       |

------

## **4. 什么时候用 `pairs` 和 `ipairs`？**

- **使用 `pairs`** → 适用于**任何类型的表**，特别是键不是连续整数的情况（如 `{name = "Alice", age = 25}`）。
- **使用 `ipairs`** → 适用于**索引从 `1` 开始、连续递增的数组**（如 `{10, 20, 30}`），保证按序访问。

------

## **5. `for i = 1, #t do` vs `ipairs`**

你也可以用 `for i = 1, #t do` 进行遍历：

```
lua复制编辑local t = {10, 20, 30, nil, 50}

for i = 1, #t do
    print(i, t[i])
end
```

#### **输出**

```
复制编辑1   10
2   20
3   30
```

🔹 这个和 `ipairs` 的行为一样，**会在 `nil` 处终止**。

如果需要遍历所有整数索引（即使中间有 `nil`），可以使用 `pairs`：

```
lua复制编辑local t = {10, 20, 30, nil, 50}
t[5] = 50  -- 显式指定索引 5

for k, v in pairs(t) do
    print(k, v)
end
```

#### **可能输出**

```
复制编辑1   10
2   20
3   30
5   50
```

🔹 `pairs` **不会因为 `nil` 终止**，所以索引 `5` 的值 `50` 仍然被访问。

------

## **6. 总结**

- **`pairs`** 适用于遍历所有键值对（哈希表、数组）。
- **`ipairs`** 适用于遍历**连续整数索引的数组**，并且**遇到 `nil` 终止**。
- **`for i = 1, #t do`** 也是遍历数组的方式，但它也会在 `nil` 处终止。
- 如果表中有跳过的索引（如 `{1, 2, nil, 4}`），使用 `pairs` 可以找到所有元素，而 `ipairs` 和 `for` 循环都会提前终止。

这样，你可以根据需要选择合适的遍历方式！ 